# –ü—Ä–æ–µ–∫—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Å–µ—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤ "–ü–∏–∫—á–∞"

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![Docker](https://img.shields.io/badge/Docker-Compose-blue)
![MongoDB](https://img.shields.io/badge/MongoDB-NoSQL-green)
![Kafka](https://img.shields.io/badge/Kafka-Streaming-red)
![ClickHouse](https://img.shields.io/badge/ClickHouse-OLAP-orange)
![Grafana](https://img.shields.io/badge/Grafana-Dashboards-yellow)
![PySpark](https://img.shields.io/badge/PySpark-3.x-blue)
![S3](https://img.shields.io/badge/S3-Storage-yellow)

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ "–ü–∏–∫—á–∞", –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∏ –≤—ã–≥–æ–¥–Ω–µ–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã. –ó–∞–∫–∞–∑—á–∏–∫ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é —Ä–∞–±–æ—á–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –¥–æ—Å—Ç—É–ø–∞ –∫ NoSQL —Ö—Ä–∞–Ω–∏–ª–∏—â—É.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤

1. **–ë–æ–ª—å—à–∞—è –ü–∏–∫—á–∞** (–ø–æ–º–µ—â–µ–Ω–∏–µ –±–æ–ª–µ–µ 200 –∫–≤.–º.)
   - 30 –º–∞–≥–∞–∑–∏–Ω–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–µ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ)

2. **–ú–∞–ª–µ–Ω—å–∫–∞—è –ü–∏–∫—á–∞** (–ø–æ–º–µ—â–µ–Ω–∏–µ –º–µ–Ω–µ–µ 100 –∫–≤.–º.)
   - 15 –º–∞–≥–∞–∑–∏–Ω–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–µ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ)

## –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤

–í –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã –ø—è—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø:

1. ü•ñ –ó–µ—Ä–Ω–æ–≤—ã–µ –∏ —Ö–ª–µ–±–æ–±—É–ª–æ—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è
2. ü•© –ú—è—Å–æ, —Ä—ã–±–∞, —è–π—Ü–∞ –∏ –±–æ–±–æ–≤—ã–µ
3. ü•õ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
4. üçè –§—Ä—É–∫—Ç—ã –∏ —è–≥–æ–¥—ã
5. ü•¶ –û–≤–æ—â–∏ –∏ –∑–µ–ª–µ–Ω—å

–í –∫–∞–∂–¥—É—é –≥—Ä—É–ø–ø—É –≤—Ö–æ–¥–∏—Ç –Ω–µ –º–µ–Ω–µ–µ 20 –ø–æ–∑–∏—Ü–∏–π (–≤—Å–µ–≥–æ –æ–∫–æ–ª–æ 100 —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–µ).

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–æ–≤–∞—Ä

```json
{
  "id": "prd-0037",
  "name": "–¢–≤–æ—Ä–æ–≥ 5%",
  "group": "–ú–æ–ª–æ—á–Ω—ã–µ",
  "description": "–¢–≤–æ—Ä–æ–≥ –∏–∑ –∫–æ—Ä–æ–≤—å–µ–≥–æ –º–æ–ª–æ–∫–∞, 5% –∂–∏—Ä–Ω–æ—Å—Ç–∏",
  "kbju": {
    "calories": 121,
    "protein": 16.5,
    "fat": 5,
    "carbohydrates": 3.3
  },
  "price": 89.99,
  "unit": "—É–ø–∞–∫–æ–≤–∫–∞",
  "origin_country": "–†–æ—Å—Å–∏—è",
  "expiry_days": 12,
  "is_organic": false,
  "barcode": "4600111222333",
  "manufacturer": {
    "name": "–û–û–û –ú–æ–ª–æ—á–Ω—ã–π –ö–æ–º–±–∏–Ω–∞—Ç",
    "country": "–†–æ—Å—Å–∏—è",
    "website": "https://moloko.ru",
    "inn": "7723456789"
  }
}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| id | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞ –≤ —Å–∏—Å—Ç–µ–º–µ |
| name | string | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ |
| group | string | –ü—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–µ–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞ |
| description | string | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| kbju | object | –ü–∏—â–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ 100 –≥ –ø—Ä–æ–¥—É–∫—Ç–∞ |
| price | number | –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É |
| unit | string | –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è (—É–ø–∞–∫–æ–≤–∫–∞, –∫–≥, –ª, —à—Ç) |
| origin_country | string | –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ |
| expiry_days | integer | –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ –≤ –¥–Ω—è—Ö |
| is_organic | boolean | –û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π –ª–∏ –ø—Ä–æ–¥—É–∫—Ç |
| barcode | string | –®—Ç—Ä–∏—Ö–∫–æ–¥ —Ç–æ–≤–∞—Ä–∞ (EAN-13) |
| manufacturer | object | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ |

### –ü–æ–∫—É–ø–∞—Ç–µ–ª—å

```json
{
  "customer_id": "cus-102345",
  "first_name": "–ê–ª–µ–∫—Å–µ–π",
  "last_name": "–ò–≤–∞–Ω–æ–≤",
  "email": "alexey.ivanov@example.com",
  "phone": "+7-900-123-45-67",
  "birth_date": "1990-04-15",
  "gender": "male",
  "registration_date": "2023-08-20T14:32:00Z",
  "is_loyalty_member": true,
  "loyalty_card_number": "LOYAL-987654321",
  "purchase_location": {
    "store_id": "store-001", 
    "store_name": "–ë–æ–ª—å—à–∞—è –ü–∏–∫—á–∞ ‚Äî –ú–∞–≥–∞–∑–∏–Ω –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π",
    "store_network": "–ë–æ–ª—å—à–∞—è –ü–∏–∫—á–∞",
    "store_type_description": "–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç –ø–ª–æ—â–∞–¥—å—é –±–æ–ª–µ–µ 200 –∫–≤.–º.",
    "country": "–†–æ—Å—Å–∏—è",
    "city": "–ú–æ—Å–∫–≤–∞",
    "street": "—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è",
    "house": "15",
    "postal_code": "125009"
  },
  "delivery_address": {
    "country": "–†–æ—Å—Å–∏—è",
    "city": "–ú–æ—Å–∫–≤–∞",
    "street": "—É–ª. –õ–µ–Ω–∏–Ω–∞",
    "house": "12",
    "apartment": "45",
    "postal_code": "101000"
  },
  "preferences": {
    "preferred_language": "ru",
    "preferred_payment_method": "card",
    "receive_promotions": true
  }
}
```

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                                    |
|------|----------|-----------------------------------------------|
| customer_id | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ | –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è                            |
| first_name/last_name | –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è | –ú–æ–∂–µ—Ç –±—ã—Ç—å NULL                               |
| email | –ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã | –ú–æ–∂–µ—Ç –±—ã—Ç—å NULL                               |
| phone | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ | –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è                            |
| birth_date | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è | –î–ª—è –∞–∫—Ü–∏–π, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏                      |
| gender | –ü–æ–ª | male, female, NULL                            |
| registration_date | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ | –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è                            |
| is_loyalty_member | –ü—Ä–∏–∑–Ω–∞–∫ —É—á–∞—Å—Ç–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | –í—Å–µ–≥–¥–∞ True                                   |
| loyalty_card_number | –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è |
| purchase_location | –ê–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞, –≥–¥–µ –±—ã–ª–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∞ | –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è                            |
| delivery_address | –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –∞–¥—Ä–µ—Å, –≥–¥–µ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –∫–∞—Ä—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ |

### –ú–∞–≥–∞–∑–∏–Ω

```json
{
  "store_id": "store-001",
  "store_name": "–ë–æ–ª—å—à–∞—è –ü–∏–∫—á–∞ ‚Äî –ú–∞–≥–∞–∑–∏–Ω –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π",
  "store_network": "–ë–æ–ª—å—à–∞—è –ü–∏–∫—á–∞",
  "store_type_description": "–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç –ø–ª–æ—â–∞–¥—å—é –±–æ–ª–µ–µ 200 –∫–≤.–º.",
  "type": "offline",
  "categories": [
    "ü•ñ –ó–µ—Ä–Ω–æ–≤—ã–µ –∏ —Ö–ª–µ–±–æ–±—É–ª–æ—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è",
    "ü•© –ú—è—Å–æ, —Ä—ã–±–∞, —è–π—Ü–∞ –∏ –±–æ–±–æ–≤—ã–µ",
    "ü•õ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã",
    "üçè –§—Ä—É–∫—Ç—ã –∏ —è–≥–æ–¥—ã",
    "ü•¶ –û–≤–æ—â–∏ –∏ –∑–µ–ª–µ–Ω—å"
  ],
  "manager": {
    "name": "–°–≤–µ—Ç–ª–∞–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞", 
    "phone": "+7-900-555-33-22",
    "email": "manager@tverskoy-store.ru"
  },
  "location": {
    "country": "–†–æ—Å—Å–∏—è",
    "city": "–ú–æ—Å–∫–≤–∞",
    "street": "—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è",
    "house": "15",
    "postal_code": "125009",
    "coordinates": {
      "latitude": 55.7575,
      "longitude": 37.6156
    }
  },
  "opening_hours": {
    "mon_fri": "09:00-21:00",
    "sat": "10:00-20:00",
    "sun": "10:00-18:00"
  },
  "accepts_online_orders": true,
  "delivery_available": true,
  "warehouse_connected": true,
  "last_inventory_date": "2025-06-28"
}
```

## –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ NoSQL —Ö—Ä–∞–Ω–∏–ª–∏—â—É –∑–∞–∫–∞–∑—á–∏–∫–∞
2. –£—á–µ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö, –ø–æ–∫—É–ø–∞—Ç–µ–ª—è—Ö –∏ –º–∞–≥–∞–∑–∏–Ω–∞—Ö.
</br>–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è [–∑–¥–µ—Å—å](/–ó–∞–¥–∞–Ω–∏–µ.pdf)

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è
### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker (Docker Desktop).

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Docker Compose:

- [docker-compose.yml](/docker-compose.yml)
- [Dockerfile.jupyter](/Dockerfile.jupyter)

#### –°–±–æ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–∑ Dockerfile-–æ–≤ (jupyter, airflow) –∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤:
`docker compose up -d --build`


### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º —Å–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç [generate_synthetic_data.py](/generate_synthetic_data.py), –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

1. 45 JSON-—Ñ–∞–π–ª–æ–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –∫–∞–∂–¥—ã–π –º–∞–≥–∞–∑–∏–Ω
2. 20 JSON-—Ñ–∞–π–ª–æ–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö —Ç–æ–≤–∞—Ä—ã
3. 45 JSON-—Ñ–∞–π–ª–æ–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π (–ø–æ 1 –ø–æ–∫—É–ø–∞—Ç–µ–ª—é –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ)
4. 200 JSON-—Ñ–∞–π–ª–æ–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –ø–æ–∫—É–ø–∫–∏ –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö

–≠—Ç–∏ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data` –ø—Ä–æ–µ–∫—Ç–∞, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø–∞–ø–∫–∞–º.

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](Photo/1.png)

#### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB

1. –° –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞ [load_data_mongo.py](load_data_mongodb/load_data_mongo.py) –∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ JSON-—Ñ–∞–π–ª—ã –≤ NoSQL —Ö—Ä–∞–Ω–∏–ª–∏—â–µ MongoDB. 

2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞ [check_mongo_data.py](load_data_mongodb/check_mongo_data.py).
</br>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [.env](load_data_mongodb/.env)

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Kafka

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ MongoDB –≤ ClickHouse –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kafka:

1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É: `pip install kafka-python`
2. –°–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã [producer.py](mongodb_kafka_clickhouse/producer.py) –∏ [consumer.py](mongodb_kafka_clickhouse/consumer.py) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Kafka
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [.env](mongodb_kafka_clickhouse/.env)

**Producer.py**:
- –°—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ MongoDB
- –ü—Ä–∏–≤–æ–¥–∏—Ç –∏—Ö –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É
- –•–µ—à–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—ã)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–æ–ø–∏–∫–∏ Kafka
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `event_time` (–¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏)

**Consumer.py**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–æ–ø–∏–∫–æ–≤ Kafka
- –°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ ClickHouse (RAW-—Å–ª–æ–π)
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü —Å —Ç–∏–ø–∞–º–∏ –ø–æ–ª–µ–π String, –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å—Ç—É–ø–∏–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ `json_data`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ ClickHouse

–î–∞–Ω–Ω—ã–µ –≤ "—Å—ã—Ä–æ–º —Å–ª–æ–µ" —Ö—Ä–∞–Ω—è—Ç—Å—è 180 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –∏—Ö –∑–∞–≥—Ä—É–∑–∫–∏ –≤ ClickHouse, –∞ –∑–∞—Ç–µ–º —É–¥–∞–ª—è—é—Ç—Å—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö

#### –°–ª–æ–π MART –≤ ClickHouse

–î–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ 3NF —Å–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π (—Ñ–∞–π–ª —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º [Script_mart.sql](Clickhouse_MART/Script_mart.sql)):

**–¢–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤**:
- `fact_purchases` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –ø–æ–∫—É–ø–æ–∫ (–≤—Ä–µ–º—è, –ø–æ–∫—É–ø–∞—Ç–µ–ª—å, –º–∞–≥–∞–∑–∏–Ω, —Å—É–º–º—ã, –º–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã)
- `fact_purchase_items` - —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–µ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Ü–µ–Ω–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å)

**–¢–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π**:
- `dim_customers` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, —É—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏)
- `dim_products` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö (–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ü–µ–Ω–∞, –ö–ë–ñ–£, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å)
- `dim_stores` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Å–µ—Ç—å, —Ç–∏–ø, –∞–¥—Ä–µ—Å, —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã)
- `categories` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤
- `manufacturers` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
- `store_networks` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Ç–µ–π
- `addresses` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
- `store_categories` - —Ç–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–∏ "–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º" –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- `duplicate_analysis_results` - —Ç–∞–±–ª–∏—Ü–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–ª—è —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–∏–∂–æ–∫ `ReplacingMergeTree()`
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

**–î–ª—è —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ReplacingMergeTree()` + TTL
- –ó–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 360 –¥–Ω–µ–π —É–¥–∞–ª—è—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**:
- –†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –¥–≤–∏–∂–æ–∫ `ReplacingMergeTree()`

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**:
- –í—Å–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
- –£–¥–∞–ª—è—é—Ç—Å—è –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã (trim())
- –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ NULL
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞—Ç

**–ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö**:
- –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è –∏–º–µ—é—Ç —Ç–∏–ø UInt64
- –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ String
- –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ Float64 –∏–ª–∏ UInt
- –ë—É–ª–µ–≤—ã –ø–æ–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ UInt8 (0/1)
- –î–∞—Ç—ã –∏ –≤—Ä–µ–º—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ Date –∏ DateTime
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ Float64

**–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è**:
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —á–µ—Ä–µ–∑ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ö–µ—à-–∫–ª—é—á (–≥–¥–µ ID –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞)
- –í—ã–±—Ä–∞–Ω –º–µ—Ç–æ–¥ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ UUID, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–≤–∏–∂–∫–æ–º ReplacingMergeTree()

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥ –≤ Grafana

#### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤

1. –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Grafana –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è URL `localhost:3000`
2. –ù–∞—Å—Ç—Ä–æ–µ–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö Altinity plugin –¥–ª—è ClickHouse (URL: `http://clickhouse:8123`)
3. –°–æ–∑–¥–∞–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫, –º–∞–≥–∞–∑–∏–Ω–æ–≤, –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

–î–∞—à–±–æ—Ä–¥ –≤ Grafana
![–î–∞—à–±–æ—Ä–¥ –≤ Grafana](Photo/2.png)

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

1. –í ClickHouse —Å–æ–∑–¥–∞–Ω–∞ —Ü–µ–ª–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–¥—Å—á–µ—Ç–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
2. –°–æ–∑–¥–∞–Ω Telegram-–±–æ—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
   - –ü–æ–ª—É—á–µ–Ω–∏–µ Chat ID —á–µ—Ä–µ–∑ @userinfobot –∏–ª–∏ @get_id_bot
3. –í Grafana –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–æ—á–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Telegram
4. –°–æ–∑–¥–∞–Ω—ã –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞
![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞](Photo/3.png)
![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞](Photo/4.png)

5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è:
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–±–æ–ª–µ–µ 50% –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
   - –°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤</br>
![–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤](Photo/5.png)</br>
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</br>
![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π](Photo/6.png)</br>
![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π](Photo/7.png)</br>
–û–±–∑–æ—Ä –≥–æ—Ç–æ–≤–æ–≥–æ –∞–ª–µ—Ä—Ç–∞</br>
![–û–±–∑–æ—Ä –≥–æ—Ç–æ–≤–æ–≥–æ –∞–ª–µ—Ä—Ç–∞](Photo/8.png)</br>
–ü–∞–Ω–µ–ª—å –∞–ª–µ—Ä—Ç–æ–≤</br>
![–ü–∞–Ω–µ–ª—å –∞–ª–µ—Ä—Ç–æ–≤](Photo/9.png)</br>
–ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram</br>
<img src="Photo/10.png" width="30%">


## –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π ETL –Ω–∞ PySpark

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á –∑–∞–∫–∞–∑—á–∏–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω ETL-–ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –≤–∏—Ç—Ä–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ 
–¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. 
</br>–ü—Ä–æ—Ü–µ—Å—Å –≤–∫–ª—é—á–∞–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ ClickHouse, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å —Ä–∞—Å—á–µ—Ç–æ–º –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ S3.

#### –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞–±–æ—Ä –∏–∑ 30 –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (0/1), –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –µ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

| ‚Ññ  | –ü—Ä–∏–∑–Ω–∞–∫                  | –û–ø–∏—Å–∞–Ω–∏–µ                                                        |
|----|--------------------------|-----------------------------------------------------------------|
| 1  | bought_milk_last_30d     | –ü–æ–∫—É–ø–∞–ª –º–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π                |
| 2  | bought_fruits_last_14d   | –ü–æ–∫—É–ø–∞–ª —Ñ—Ä—É–∫—Ç—ã –∏ —è–≥–æ–¥—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π                  |
| 3  | not_bought_veggies_14d   | –ù–µ –ø–æ–∫—É–ø–∞–ª –æ–≤–æ—â–∏ –∏ –∑–µ–ª–µ–Ω—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π                 |
| 4  | recurrent_buyer          | –î–µ–ª–∞–ª –±–æ–ª–µ–µ 2 –ø–æ–∫—É–ø–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π                     |
| 5  | inactive_14_30           | –ù–µ –ø–æ–∫—É–ø–∞–ª 14‚Äì30 –¥–Ω–µ–π (—É—à–µ–¥—à–∏–π –∫–ª–∏–µ–Ω—Ç?)                        |
| 6  | new_customer             | –ü–æ–∫—É–ø–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –º–µ–Ω–µ–µ 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥              |
| 7  | delivery_user            | –ü–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–æ—Å—Ç–∞–≤–∫–æ–π —Ö–æ—Ç—è –±—ã —Ä–∞–∑                             |
| 8  | organic_preference       | –ö—É–ø–∏–ª —Ö–æ—Ç—è –±—ã 1 –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–¥—É–∫—Ç                            |
| 9  | bulk_buyer               | –°—Ä–µ–¥–Ω—è—è –∫–æ—Ä–∑–∏–Ω–∞ > 1000‚ÇΩ                                   |
| 10 | low_cost_buyer           | –°—Ä–µ–¥–Ω—è—è –∫–æ—Ä–∑–∏–Ω–∞ < 200‚ÇΩ                                    |
| 11 | buys_bakery              | –ü–æ–∫—É–ø–∞–ª —Ö–ª–µ–±/–≤—ã–ø–µ—á–∫—É —Ö–æ—Ç—è –±—ã —Ä–∞–∑                             |
| 12 | loyal_customer           | –õ–æ—è–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç (–∫–∞—Ä—Ç–∞ –∏ ‚â•3 –ø–æ–∫—É–ø–∫–∏)                      |
| 13 | multicity_buyer          | –î–µ–ª–∞–ª –ø–æ–∫—É–ø–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö                                |
| 14 | bought_meat_last_week   | –ü–æ–∫—É–ø–∞–ª –º—è—Å–æ/—Ä—ã–±—É/—è–π—Ü–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é                   |
| 15 | night_shopper            | –î–µ–ª–∞–ª –ø–æ–∫—É–ø–∫–∏ –ø–æ—Å–ª–µ 20:00                                    |
| 16 | morning_shopper          | –î–µ–ª–∞–ª –ø–æ–∫—É–ø–∫–∏ –¥–æ 10:00                                    |
| 17 | prefers_cash             | –û–ø–ª–∞—á–∏–≤–∞–ª –Ω–∞–ª–∏—á–Ω—ã–º–∏ ‚â• 70% –ø–æ–∫—É–ø–æ–∫                            |
| 18 | prefers_card             | –û–ø–ª–∞—á–∏–≤–∞–ª –∫–∞—Ä—Ç–æ–π ‚â• 70% –ø–æ–∫—É–ø–æ–∫                               |
| 19 | weekend_shopper          | –î–µ–ª–∞–ª ‚â• 60% –ø–æ–∫—É–ø–æ–∫ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ                                |
| 20 | weekday_shopper          | –î–µ–ª–∞–ª ‚â• 60% –ø–æ–∫—É–ø–æ–∫ –≤ –±—É–¥–Ω–∏                                  |
| 21 | single_item_buyer        | ‚â•50% –ø–æ–∫—É–ø–æ–∫ ‚Äî 1 —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω–µ                               |
| 22 | varied_shopper           | –ü–æ–∫—É–ø–∞–ª ‚â•4 —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤                          |
| 23 | store_loyal              | –•–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–∏–Ω –º–∞–≥–∞–∑–∏–Ω                                  |
| 24 | switching_store          | –•–æ–¥–∏—Ç –≤ —Ä–∞–∑–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã                                      |
| 25 | family_shopper           | –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª-–≤–æ –ø–æ–∑–∏—Ü–∏–π –≤ –∫–æ—Ä–∑–∏–Ω–µ ‚â•4                           |
| 26 | early_bird               | –ü–æ–∫—É–ø–∫–∞ –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É 12 –∏ 15 —á–∞—Å–∞–º–∏ –¥–Ω—è                |
| 27 | no_purchases             | –ù–µ —Å–æ–≤–µ—Ä—à–∞–ª –Ω–∏ –æ–¥–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ (—Ç–æ–ª—å–∫–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)            |
| 28 | recent_high_spender      | –ö—É–ø–∏–ª –Ω–∞ —Å—É–º–º—É >2000‚ÇΩ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π                    |
| 29 | fruit_lover              | ‚â•3 –ø–æ–∫—É–ø–æ–∫ —Ñ—Ä—É–∫—Ç–æ–≤ –∑–∞ 30 –¥–Ω–µ–π                                |
| 30 | vegetarian_profile       | –ù–µ –∫—É–ø–∏–ª –Ω–∏ –æ–¥–Ω–æ–≥–æ –º—è—Å–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∑–∞ 90 –¥–Ω–µ–π              |

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ PySpark
–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ PySpark –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. –°–æ–∑–¥–∞–Ω  [Dockerfile.jupyter](notebooks/Dockerfile.jupyter) —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ JupyterLab 
2. –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã JupyterLab –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π docker-compose.yaml 
3. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å S3 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å–µ Selectel `https://selectel.ru/services/cloud/storage/`
4. –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è [config.py](notebooks/config.py)
5. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å PySpark –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∞–π–ª [PySpark_ETL.ipynb](notebooks/PySpark_ETL.ipynb)

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å JupyterLab –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É `http://localhost:8888`

–§–∞–π–ª `PySpark_ETL.ipynb` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
* –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î ClickHouse –∏ S3
* –°–æ–∑–¥–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
* –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Ä–∞—Å—á–µ—Ç –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
* –í—ã–≤–æ–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –∏—Ç–æ–≥–æ–≤–æ–≥–æ df
* –§–æ—Ä–º–∏—Ä—É–µ—Ç, –∏–º–µ–Ω—É–µ—Ç —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç—ã –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–¥–∏–Ω—ã–π CSV-—Ñ–∞–π–ª —Ç–∞–∫–æ–≥–æ —Ç–∏–ø–∞: 
[feature_matrix_2025-10-05_15-20-35.csv](notebooks/feature_matrix_2025-10-05_15-20-35.csv)
* –ó–∞–≥—Ä—É–∂–∞–µ—Ç CSV-—Ñ–∞–π–ª –≤ S3

–ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –≤ S3</br>
![–ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏](Photo/11.png)</br>

## C–æ–∑–¥–∞–Ω–∏–µ –æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ Airflow

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ data
‚îÇ   ‚îú‚îÄ‚îÄ customers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ customer_001.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ customer_045.json
‚îÇ   ‚îú‚îÄ‚îÄ products
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product_001.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ product_020.json
‚îÇ   ‚îú‚îÄ‚îÄ purchases
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ purchase_001.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ purchase_200.json
‚îÇ   ‚îî‚îÄ‚îÄ stores
‚îÇ       ‚îú‚îÄ‚îÄ store_001.json
‚îÇ       ‚îú‚îÄ‚îÄ ...
‚îÇ       ‚îî‚îÄ‚îÄ store_045.json
‚îú‚îÄ‚îÄ dags
‚îÇ   ‚îú‚îÄ‚îÄ kafka_producer_consumer_DAG.py
‚îÇ   ‚îî‚îÄ‚îÄ tables_mart_DAG.py
‚îú‚îÄ‚îÄ load_data_mongodb
‚îÇ   ‚îú‚îÄ‚îÄ .env
‚îÇ   ‚îú‚îÄ‚îÄ check_mongo_data.py
‚îÇ   ‚îî‚îÄ‚îÄ load_data_mongo.py
‚îú‚îÄ‚îÄ mongodb_kafka_clickhouse
‚îÇ   ‚îú‚îÄ‚îÄ .env
‚îÇ   ‚îú‚îÄ‚îÄ consumer.py
‚îÇ   ‚îî‚îÄ‚îÄ producer.py
‚îú‚îÄ‚îÄ notebooks
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ feature_matrix_2025-10-05_15-20-35.csv
‚îÇ   ‚îú‚îÄ‚îÄ feature_matrix_2025-10-05_15-20-39.csv
‚îÇ   ‚îî‚îÄ‚îÄ PySpark_ETL.ipynb
‚îú‚îÄ‚îÄ Clickhouse_MART
‚îÇ   ‚îî‚îÄ‚îÄ Script_mart.sql
‚îú‚îÄ‚îÄ Photo
‚îÇ   ‚îî‚îÄ‚îÄ screenshots...
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile.airflow
‚îú‚îÄ‚îÄ Dockerfile.jupyter
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ generate_synthetic_data.py
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤–∫–ª—é—á–∞–µ—Ç:
- **data** - –ø–∞–ø–∫–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—á–∏–∫–∞
  - **customers** - 45 JSON-—Ñ–∞–π–ª–æ–≤ —Ç–∞–±–ª–∏—Ü—ã customers
  - **products** - 20 JSON-—Ñ–∞–π–ª–æ–≤ —Ç–∞–±–ª–∏—Ü—ã products
  - **purchases** - 200 JSON-—Ñ–∞–π–ª–æ–≤ —Ç–∞–±–ª–∏—Ü—ã purchases
  - **stores** - 45 JSON-—Ñ–∞–π–ª–æ–≤ —Ç–∞–±–ª–∏—Ü—ã stores
- **dags** - –ø–∞–ø–∫–∞ —Å DAG-—Ñ–∞–π–ª–∞–º–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞—á –≤ Airflow
  - **kafka_producer_consumer_DAG.py** - DAG-—Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ producer.py –∏ consumer.py –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
  - **tables_mart_DAG.py** - DAG-—Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ MART-—Å–ª–æ–µ
- **load_data_mongodb** - –ø–∞–ø–∫–∞ —Å–æ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB
  - **.env** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  - **check_mongo_data.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB
  - **load_data_mongo.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **mongodb_kafka_clickhouse** - –ø–∞–ø–∫–∞ —Å–æ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ MongoDB –≤ ClickHouse —á–µ—Ä–µ–∑ Kafka
  - **.env** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  - **consumer.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ ClickHouse
  - **producer.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ MongoDB
- **Clickhouse_MART** - –ø–∞–ø–∫–∞ —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MART-—Å–ª–æ—è —Ç–∞–±–ª–∏—Ü
  - **Script_mart.sql** - SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ MART-—Ç–∞–±–ª–∏—Ü—ã
- **notebooks** - –ø–∞–ø–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ JupyterLab
  - **config.py** - —Ñ–∞–π–ª —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ClickHouse –∏ S3
  - **feature_matrix_2025-10-05_15-20-35.csv** - —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª csv
  - **feature_matrix_2025-10-05_15-20-39.csv** - —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª csv
  - **PySpark_ETL.ipynb** - —Ñ–∞–π–ª JupyterLab –¥–ª—è —Ä–∞–±–æ—Ç—ã c PySpark
- **Photo** - –ø–∞–ø–∫–∞ —Å–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏
- **docker-compose.yml** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
- **Dockerfile.airflow** - Dockerfile c –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Airflow
- **Dockerfile.jupyter** - Dockerfile c –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è JupyterLab
- **requirements.txt** - —Ñ–∞–π–ª c –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–∏ Airflow
- **generate_synthetic_data.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö


### –ê–≤—Ç–æ—Ä:

–ö–∞—Ç–µ—Ä–∏–Ω–∞ –õ–∞–ø–ø–∞
